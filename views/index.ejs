<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day's Checker</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f4f4f9;
        }
        h1 {
            color: #333;
        }
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 15px;
            width: 90%;
            max-width: 800px;
        }
        .day {
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            background-color: #fff;
            text-align: center;
            transition: transform 0.2s;
        }
        .day:hover {
            transform: scale(1.05);
        }
        .today {
            background-color: #e0f7fa;
            font-weight: bold;
        }
        .notes, .events, .progress {
            margin-top: 10px;
            text-align: left;
        }
        .notes h3, .events h3, .progress h3 {
            margin-bottom: 5px;
        }
        .notes ul, .events ul {
            list-style-type: none;
            padding: 0;
        }
        .notes li, .events li {
            background-color: #f9f9f9;
            margin-bottom: 5px;
            padding: 5px;
            border-radius: 5px;
        }
        .notes form, .events form, .progress form {
            display: flex;
            flex-direction: column;
        }
        .notes input[type="text"], .events input[type="text"], .progress input[type="number"] {
            padding: 8px;
            margin-bottom: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .notes button, .events button, .progress button {
            padding: 8px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .notes button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1><%= message %></h1>
    <p><%= advice %></p>
    <div class="calendar">
        <% weekDays.forEach((dayInfo, index) => { %>
            <div class="day <%= index === new Date().getDay() ? 'today' : '' %>">
                <h2><%= dayInfo.day %></h2>
                <p><%= dayInfo.message %></p>
                <p><%= dayInfo.advice %></p>
                <div class="notes">
                    <h3>Notes:</h3>
                    <ul>
                        <% dayInfo.notes.forEach(note => { %>
                            <li><%= note %></li>
                        <% }) %>
                    </ul>
                    <form action="/add-note" method="POST">
                        <input type="hidden" name="dayIndex" value="<%= index %>">
                        <input type="text" name="note" placeholder="Add a note" required>
                        <button type="submit">Add</button>
                    </form>
                </div>
                <div class="events">
                    <h3>Events:</h3>
                    <ul>
                        <% dayInfo.events.forEach(event => { %>
                            <li><%= event %></li>
                        <% }) %>
                    </ul>
                    <form action="/add-event" method="POST">
                        <input type="hidden" name="dayIndex" value="<%= index %>">
                        <input type="text" name="event" placeholder="Add an event" required>
                        <button type="submit">Add</button>
                    </form>
                </div>
                <div class="progress">
                    <h3>Progress:</h3>
                    <p>Progress: <%= dayInfo.progress %>%</p>
                    <form action="/update-progress" method="POST">
                        <input type="hidden" name="dayIndex" value="<%= index %>">
                        <input type="number" name="progress" min="0" max="100" value="<%= dayInfo.progress %>" required>
                        <button type="submit">Update</button>
                    </form>
                </div>
            </div>
        <% }) %>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const notes = JSON.parse(localStorage.getItem('notes')) || {};
            document.querySelectorAll('.day').forEach((dayElement, index) => {
                const dayNotes = notes[index] || [];
                const notesList = dayElement.querySelector('ul');
                dayNotes.forEach(note => {
                    const li = document.createElement('li');
                    li.textContent = note;
                    notesList.appendChild(li);
                });
                dayElement.querySelector('form').addEventListener('submit', (event) => {
                    event.preventDefault();
                    const noteInput = event.target.querySelector('input[name="note"]');
                    const note = noteInput.value;
                    if (!notes[index]) {
                        notes[index] = [];
                    }
                    notes[index].push(note);
                    localStorage.setItem('notes', JSON.stringify(notes));
                    const li = document.createElement('li');
                    li.textContent = note;
                    notesList.appendChild(li);
                    noteInput.value = '';
                });
            });
        });
    </script>
</body>
</html>
